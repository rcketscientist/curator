apply plugin: 'android'

def versionMajor = 2
def versionMinor = 5
def versionPatch = 9
def versionBuild = 0

android {
    compileSdkVersion 21
    buildToolsVersion "19.1.0"

//    useOldManifestMerger true //the new one causes tons of manifest errors

    defaultConfig {
        minSdkVersion 11    // Changed for showcaseview, 10 is 0.17% of users
        targetSdkVersion 21
        versionName "${versionMajor}.${versionMinor}" + ((versionPatch != 0) ? ".${versionPatch}" : "")
        ndk {
            moduleName "libraw"
        }
    }

    signingConfigs {
        release {
            storeFile file("../key/my-release-key.keystore")
            storePassword "***REMOVED***"
            keyAlias "alias_name"
            keyPassword "***REMOVED***"
        }
    }

    buildTypes {
        release {
            minifyEnabled true
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.txt'
            signingConfig signingConfigs.release
        }
    }

    sourceSets.main {
        jni.srcDirs = [] //disable automatic ndk-build call (currently broken for windows)
    }

    productFlavors {
        // These fields handle flavorized authorities for providers
        final FIELD_META = "PROVIDER_AUTHORITY_META"
        final FIELD_SWAP = "PROVIDER_AUTHORITY_SWAP"
        final PROVIDER_META = "\"com.anthonymandra.content.MetaProvider\""
        final PROVIDER_SWAP = "\"com.anthonymandra.rawdroid.SwapProvider\""
        final PROVIDER_META_PRO = "\"com.anthonymandra.content.MetaProvider.pro\""
        final PROVIDER_SWAP_PRO = "\"com.anthonymandra.rawdroid.SwapProvider.pro\""
        demo {
            applicationId 'com.anthonymandra.rawdroid'
            buildConfigField "String", FIELD_META, PROVIDER_META
            buildConfigField "String", FIELD_SWAP, PROVIDER_SWAP
        }
        pro {
            applicationId 'com.anthonymandra.rawdroidpro'
            buildConfigField "String", FIELD_META, PROVIDER_META_PRO
            buildConfigField "String", FIELD_SWAP, PROVIDER_SWAP_PRO
        }
        proAmazon {
            applicationId 'com.anthonymandra.rawdroidpro'
            buildConfigField "String", FIELD_META, PROVIDER_META_PRO
            buildConfigField "String", FIELD_SWAP, PROVIDER_SWAP_PRO
        }
    }
}

dependencies {
    compile project(':showcaseView:library')
    compile project(':inscription')
    compile project(':treeviewlistandroid')
    compile project(':metaDataExtractor')
    compile project(':oIFileManager')
//    compile project(':fileManager:FileManager')
    compile 'com.android.support:support-v4:20.+'
    //Changed for Android-L ('com.android.support:support-v4:+')
    compile 'com.actionbarsherlock:actionbarsherlock:4.4.0@aar'
//    compile files('libs/jcifs-1.3.17.jar')
//    compile files('libs/xmpcore-5.1.2.jar')
    //    proCompile project(':play_licensing:library')
}